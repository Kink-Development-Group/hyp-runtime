Focus {

    entrance {
        observe "Welcome to the extended HypnoScript world!";
        drift(1000);
        observe "All new features will now be demonstrated...";
        drift(500);
    }

    // ===== BASIC FEATURES =====;

    // Variable declarations with different types
    induce greeting: string = "Hello from HypnoScript!";
    induce counter: number = 0;
    induce isActive: boolean = true;
    induce userInput: string from external;

    // Mathematical calculations
    induce x: number = 10;
    induce y: number = 5;
    induce result: number = x * y + 15;

    // ===== EXTENDED DATA STRUCTURES =====;

    // Define tranceify structure
    tranceify HypnoRecord {
        name: string;
        age: number;
        isInTrance: boolean;
        tranceLevel: number;
    }

    // Create record instance
    induce record = HypnoRecord {
        name: "Alice",
        age: 30,
        isInTrance: true,
        tranceLevel: 8.5
    };

    // Field access on record
    observe "Record Name: " + record.name;
    observe "Trance Level: " + record.tranceLevel;

    // ===== OBJECT ORIENTATION =====;

    // Define session (class)
    session Person {
        expose name: string;
        expose tranceLevel: number;
        conceal secretId: number;

        suggestion constructor(newName: string, id: number) {
            this.name = newName;
            this.secretId = id;
            this.tranceLevel = 0;
        }

        suggestion enterTrance() {
            this.tranceLevel = this.tranceLevel + 1;
            observe this.name + " enters deeper trance...";
        }

        suggestion greet() {
            observe "Hello, " + this.name + " (Trance Level: " + this.tranceLevel + ")";
        }

        suggestion deepTrance() {
            while (this.tranceLevel < 10) {
                this.enterTrance();
                drift(500);
            }
            observe this.name + " is now in deep trance!";
        }
    }

    // Create session instances
    induce person1 = Person("Bob", 123);
    induce person2 = Person("Charlie", 456);

    // Call methods
    person1.greet();
    person1.enterTrance();
    person1.greet();

    // ===== CONTROL STRUCTURES =====;

    // If-Else with hypnotic operators
    if (counter youAreFeelingVerySleepy 0) deepFocus {
        observe "Counter is zero - starting fresh!";
    } else if (counter lookAtTheWatch 5) deepFocus {
        observe "Counter is getting higher...";
    } else deepFocus {
        observe "Counter is in the middle range.";
    }

    // While loop with hypnotic operators
    while (counter fallUnderMySpell 5) {
        counter = counter + 1;
        observe "Counter: " + counter;
        drift(200);
    }

    // Loop statement (similar to for-loop)
    loop (induce i: number = 0; i < 3; i = i + 1) {
        if (i youAreFeelingVerySleepy 1) deepFocus {
            observe "First iteration!";
        } else if (i lookAtTheWatch 2) deepFocus {
            snap;  // Break from the loop
        }
        observe "Loop iteration: " + i;
    }

    // ===== FUNCTIONS =====;

    // Function with return value
    suggestion add(a: number, b: number): number {
        awaken a + b;
    }

    // Function without return value (imperative)
    imperative suggestion printHypnoticMessage(message: string) {
        observe "*** " + message + " ***";
        drift(1000);
    }

    // Function with multiple parameters
    suggestion calculateTranceLevel(baseLevel: number, bonus: number): number {
        induce result: number = baseLevel + bonus;
        if (result lookAtTheWatch 10) deepFocus {
            result = 10;  // Maximum trance level
        }
        awaken result;
    }

    // Function calls
    induce sum = call add(5, 7);
    observe "Sum: " + sum;

    printHypnoticMessage("You are feeling very relaxed...");

    induce tranceLevel = calculateTranceLevel(6, 3);
    observe "Calculated trance level: " + tranceLevel;

    // ===== ARRAYS AND COLLECTIONS =====;

    // Array literal (if supported)
    induce numbers = [1, 2, 3, 4, 5];
    induce names = ["Alice", "Bob", "Charlie"];

    // ===== EXTENDED FEATURES =====;

    // Shared Trance (global variables)
    sharedTrance globalCounter: number = 0;

    // MindLink (Import) - will be implemented later
    // mindLink "math.hyp";

    // Labels and Goto (if supported)
    // startLabel:
    // observe "Label reached!";
    // if (counter < 10) sinkTo startLabel;

    // ===== HYPNOTIC SPECIAL EFFECTS =====;

    observe "Starting hypnotic demonstration...";
    drift(2000);

    // Hypnotic countdown
    loop (induce i: number = 5; i > 0; i = i - 1) {
        observe "You are feeling very sleepy... " + i;
        drift(1000);
    }

    observe "You are now in a deep hypnotic state!";
    drift(3000);

    // ===== COMPLEX CALCULATIONS =====;

    // Mathematical functions via builtins
    induce angle: number = 45;
    induce sinValue = call Sin(angle);
    induce cosValue = call Cos(angle);

    observe "Sin(" + angle + ") = " + sinValue;
    observe "Cos(" + angle + ") = " + cosValue;

    // String manipulation
    induce testString: string = "hypnotic programming";
    induce upperString = call ToUpper(testString);
    induce stringLength = call Length(testString);

    observe "Original: " + testString;
    observe "Uppercase: " + upperString;
    observe "Length: " + stringLength;

    // ===== ERROR HANDLING AND EDGE CASES =====;

    // Avoid division by zero
    induce divisor: number = 0;
    if (divisor youAreFeelingVerySleepy 0) deepFocus {
        observe "Cannot divide by zero!";
    } else deepFocus {
        induce quotient = result / divisor;
        observe "Quotient: " + quotient;
    }

    // ===== FINAL DEMONSTRATION =====;

    observe "Final demonstration of all features...";
    drift(1000);

    // Complex session interaction
    person2.deepTrance();
    person2.greet();

    // Record manipulation
    record.tranceLevel = record.tranceLevel + 2;
    observe "Updated trance level: " + record.tranceLevel;

    // Final output
    observe "HypnoScript demonstration complete!";
    observe "All features working: ✓";
    observe "Turing-complete: ✓";
    observe "Hypnotic: ✓";

    drift(2000);
    observe "Program ending...";

} Relax
